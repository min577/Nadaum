<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë£¨í‹´ ê´€ë¦¬ - ë‚˜ë‹¤ì›€</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #f5f5f5;
            padding-bottom: 70px;
        }

        .header {
            background: white;
            padding: 16px 20px;
            border-bottom: 1px solid #eee;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header h1 {
            font-size: 20px;
            font-weight: 600;
            color: #333;
        }

        .main-tabs {
            display: flex;
            background: white;
            border-bottom: 1px solid #eee;
            position: sticky;
            top: 57px;
            z-index: 99;
        }

        .main-tab {
            flex: 1;
            padding: 16px;
            text-align: center;
            font-size: 15px;
            font-weight: 500;
            color: #999;
            background: none;
            border: none;
            border-bottom: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s;
        }

        .main-tab.active {
            color: #6C63FF;
            border-bottom-color: #6C63FF;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .dashboard-section {
            padding: 20px;
        }

        .calendar-streak {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .calendar-header h3 {
            font-size: 18px;
            font-weight: 600;
        }

        .month-nav {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .month-nav button {
            background: none;
            border: none;
            font-size: 18px;
            cursor: pointer;
            color: #666;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
        }

        .calendar-day-header {
            text-align: center;
            font-size: 12px;
            color: #999;
            padding: 8px 0;
            font-weight: 500;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            font-size: 14px;
            position: relative;
        }

        .calendar-day.completed {
            background: #E8F5E9;
            color: #4CAF50;
            font-weight: 600;
        }

        .calendar-day.today {
            border: 2px solid #6C63FF;
        }

        .calendar-day.empty {
            color: #ddd;
        }

        .avatar-section {
            background: white;
            border-radius: 16px;
            padding: 24px;
            text-align: center;
        }

        .avatar-section h3 {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .avatar-container {
            width: 150px;
            height: 150px;
            margin: 0 auto 20px;
            position: relative;
        }

        .avatar-image {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 60px;
            position: relative;
            overflow: visible;
        }

        .food-particles {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 8px;
        }

        .food-particle {
            font-size: 20px;
            animation: float 2s ease-in-out infinite;
        }

        .food-particle:nth-child(2) {
            animation-delay: 0.3s;
        }

        .food-particle:nth-child(3) {
            animation-delay: 0.6s;
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        .avatar-level {
            position: absolute;
            bottom: 0;
            right: 0;
            background: #6C63FF;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
            border: 3px solid white;
        }

        .avatar-stats {
            display: flex;
            justify-content: center;
            gap: 32px;
            margin-top: 20px;
        }

        .avatar-stat {
            text-align: center;
        }

        .avatar-stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #6C63FF;
            margin-bottom: 4px;
        }

        .avatar-stat-label {
            font-size: 13px;
            color: #999;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #f0f0f0;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 16px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #6C63FF 0%, #9D8CFF 100%);
            border-radius: 4px;
            transition: width 0.3s;
        }

        .progress-text {
            text-align: center;
            margin-top: 8px;
            font-size: 13px;
            color: #666;
        }

        .routine-section {
            padding: 0;
        }

        .date-selector {
            background: white;
            padding: 16px 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .date-display {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 16px;
            font-weight: 600;
        }

        .date-nav {
            display: flex;
            gap: 12px;
        }

        .date-nav button {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #666;
        }

        .routine-list {
            padding: 20px;
        }

        .routine-category {
            margin-bottom: 24px;
        }

        .category-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
            padding-left: 4px;
        }

        .category-icon {
            font-size: 20px;
        }

        .category-title {
            font-size: 15px;
            font-weight: 600;
            color: #333;
        }

        .routine-item {
            background: white;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .routine-checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid #ddd;
            border-radius: 50%;
            cursor: pointer;
            flex-shrink: 0;
            transition: all 0.3s;
        }

        .routine-checkbox.checked {
            background: #6C63FF;
            border-color: #6C63FF;
            position: relative;
        }

        .routine-checkbox.checked::after {
            content: 'âœ“';
            color: white;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 14px;
        }

        .routine-info {
            flex: 1;
        }

        .routine-name {
            font-size: 15px;
            font-weight: 500;
            color: #333;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .challenge-badge {
            background: linear-gradient(135deg, #FF6B6B 0%, #FF8E53 100%);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
        }

        .routine-time {
            font-size: 13px;
            color: #999;
        }

        .routine-actions {
            display: flex;
            gap: 8px;
        }

        .edit-btn {
            padding: 6px 12px;
            background: #f5f5f5;
            border: none;
            border-radius: 6px;
            font-size: 13px;
            color: #666;
            cursor: pointer;
        }

        .add-routine-btn {
            position: fixed;
            bottom: 90px;
            right: 20px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, #6C63FF 0%, #5A52D5 100%);
            color: white;
            border: none;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(108, 99, 255, 0.3);
            z-index: 50;
        }

        .ai-suggestion {
            background: linear-gradient(135deg, #E8F5E9 0%, #F1F8FF 100%);
            border-radius: 16px;
            padding: 20px;
            margin: 20px;
        }

        .ai-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
        }

        .ai-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
        }

        .ai-description {
            font-size: 14px;
            color: #666;
            margin-bottom: 16px;
            line-height: 1.5;
        }

        .suggested-routines {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 16px;
        }

        .suggested-routine {
            background: white;
            padding: 12px;
            border-radius: 8px;
            font-size: 14px;
            color: #333;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .suggested-routine:hover {
            background: #f8f9ff;
        }

        .suggested-routine.selected {
            background: #E8F5E9;
            border-color: #4CAF50;
        }

        .apply-btn {
            width: 100%;
            padding: 14px;
            background: #6C63FF;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
        }

        .nav-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: space-around;
            padding: 8px 0 20px 0;
            z-index: 100;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 8px 16px;
            color: #999;
            text-decoration: none;
            font-size: 12px;
        }

        .nav-item.active {
            color: #6C63FF;
        }

        .nav-icon {
            font-size: 24px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: flex-end;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 20px 20px 0 0;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            padding: 24px 20px 40px 20px;
            animation: slideUp 0.3s;
        }

        @keyframes slideUp {
            from {
                transform: translateY(100%);
            }
            to {
                transform: translateY(0);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            color: #999;
            cursor: pointer;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .form-label.optional::after {
            content: ' (ì„ íƒ)';
            color: #999;
            font-weight: 400;
            font-size: 12px;
        }

        .form-input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 15px;
        }

        .category-select {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }

        .category-option {
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .category-option.selected {
            background: #6C63FF;
            color: white;
            border-color: #6C63FF;
        }

        .day-select-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .select-all-btn {
            background: #6C63FF;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 13px;
            cursor: pointer;
        }

        .day-select {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
        }

        .day-option {
            padding: 12px 8px;
            border: 1px solid #ddd;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }

        .day-option.selected {
            background: #6C63FF;
            color: white;
            border-color: #6C63FF;
        }

        .time-input {
            display: flex;
            gap: 8px;
        }

        .submit-btn {
            width: 100%;
            padding: 16px;
            background: #6C63FF;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 24px;
        }

        .edit-action-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1001;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .edit-action-modal.active {
            display: flex;
        }

        .edit-action-content {
            background: white;
            border-radius: 16px;
            width: 100%;
            max-width: 300px;
            padding: 20px;
        }

        .edit-action-btn {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 8px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 8px;
        }

        .edit-action-btn.modify {
            background: #6C63FF;
            color: white;
        }

        .edit-action-btn.delete {
            background: #f5f5f5;
            color: #FF6B6B;
        }

        .edit-action-btn.cancel {
            background: #f5f5f5;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ë£¨í‹´ ê´€ë¦¬</h1>
    </div>

    <div class="main-tabs">
        <button class="main-tab active" onclick="switchMainTab('dashboard')">ëŒ€ì‹œë³´ë“œ</button>
        <button class="main-tab" onclick="switchMainTab('routine')">ì˜¤ëŠ˜ì˜ ë£¨í‹´</button>
    </div>

    <div id="dashboardTab" class="tab-content active">
        <div class="dashboard-section">
            <div class="avatar-section">
                <h3>ì—°ì† ë‹¬ì„± ê¸°ë¡</h3>
                <div class="avatar-container">
                    <div class="avatar-image">
                        <div class="food-particles">
                            <span class="food-particle">ğŸ‚</span>
                            <span class="food-particle">ğŸ¥•</span>
                            <span class="food-particle">ğŸ¥—</span>
                        </div>
                        ğŸŒ±
                    </div>
                    <div class="avatar-level">5</div>
                </div>
                <div class="avatar-stats">
                    <div class="avatar-stat">
                        <div class="avatar-stat-value">47</div>
                        <div class="avatar-stat-label">ì™„ë£Œí•œ ë£¨í‹´</div>
                    </div>
                    <div class="avatar-stat">
                        <div class="avatar-stat-value">12</div>
                        <div class="avatar-stat-label">ì—°ì† ë‹¬ì„±ì¼</div>
                    </div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 60%"></div>
                </div>
                <div class="progress-text">ë‹¤ìŒ ë ˆë²¨ê¹Œì§€ 20ê°œ</div>
            </div>
            <div class="calendar-streak">
                <div class="calendar-header">
                    <h3>ìº˜ë¦°ë” ìŠ¤íŠ¸ë¦­</h3>
                    <div class="month-nav">
                        <button onclick="previousMonth()">â—€</button>
                        <span id="currentMonth">2024ë…„ 11ì›”</span>
                        <button onclick="nextMonth()">â–¶</button>
                    </div>
                </div>
                <div class="calendar-grid">
                    <div class="calendar-day-header">ì¼</div>
                    <div class="calendar-day-header">ì›”</div>
                    <div class="calendar-day-header">í™”</div>
                    <div class="calendar-day-header">ìˆ˜</div>
                    <div class="calendar-day-header">ëª©</div>
                    <div class="calendar-day-header">ê¸ˆ</div>
                    <div class="calendar-day-header">í† </div>
                </div>
                <div class="calendar-grid" id="calendarDays"></div>
            </div>
        </div>
    </div>

    <div id="routineTab" class="tab-content">
        <div class="routine-section">
            <div class="date-selector">
                <div class="date-display">
                    <span>ğŸ“…</span>
                    <span id="selectedDate">2024ë…„ 11ì›” 21ì¼ (ëª©)</span>
                </div>
                <div class="date-nav">
                    <button onclick="previousDay()">â—€</button>
                    <button onclick="nextDay()">â–¶</button>
                </div>
            </div>
            <div class="ai-suggestion">
                <div class="ai-header">
                    <span>âœ¨</span>
                    <span class="ai-title">Nadaumì˜ ì¶”ì²œ</span>
                </div>
                <div class="ai-description">
                    íšŒì›ë‹˜ì˜ ë£¨í‹´ íŒ¨í„´ì„ ë¶„ì„í•œ ê²°ê³¼, ì•„ë˜ ë£¨í‹´ì„ ì¶”ê°€í•˜ë©´ ëª©í‘œ ë‹¬ì„±ì— ë„ì›€ì´ ë  ê²ƒ ê°™ì•„ìš”!
                </div>
                <div class="suggested-routines">
                    <div class="suggested-routine" data-routine='{"name":"ì €ë… ëª…ìƒ 10ë¶„","category":"recovery","startTime":"22:00","endTime":"22:10","days":["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "]}' onclick="toggleSuggestedRoutine(this)">
                        ğŸ§˜ ì €ë… ëª…ìƒ 10ë¶„ (ì˜¤í›„ 10:00)
                    </div>
                    <div class="suggested-routine" data-routine='{"name":"ì·¨ì¹¨ ì „ ë…ì„œ 20ë¶„","category":"habit","startTime":"22:30","endTime":"22:50","days":["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "]}' onclick="toggleSuggestedRoutine(this)">
                        ğŸ“– ì·¨ì¹¨ ì „ ë…ì„œ 20ë¶„ (ì˜¤í›„ 10:30)
                    </div>
                </div>
                <button class="apply-btn" onclick="applyRecommendations()">ì„ íƒí•œ ë£¨í‹´ ì¶”ê°€í•˜ê¸°</button>
            </div>

            <div class="routine-list" id="routineList">
                <div class="routine-category" data-category="exercise">
                    <div class="category-header">
                        <span class="category-icon">ğŸƒ</span>
                        <span class="category-title">ìš´ë™</span>
                    </div>
                    <div class="routine-item" data-id="routine-1">
                        <div class="routine-checkbox checked" onclick="toggleRoutine(this)"></div>
                        <div class="routine-info">
                            <div class="routine-name">
                                ì•„ì¹¨ ì¡°ê¹… 30ë¶„
                                <span class="challenge-badge">ì±Œë¦°ì§€</span>
                            </div>
                            <div class="routine-time">ì˜¤ì „ 7:00 - 7:30</div>
                        </div>
                        <button class="edit-btn" onclick="showEditActions('routine-1')">í¸ì§‘</button>
                    </div>
                    <div class="routine-item" data-id="routine-2">
                        <div class="routine-checkbox" onclick="toggleRoutine(this)"></div>
                        <div class="routine-info">
                            <div class="routine-name">í”Œë­í¬ 2ë¶„</div>
                            <div class="routine-time">ì˜¤í›„ 8:00 - 8:02</div>
                        </div>
                        <button class="edit-btn" onclick="showEditActions('routine-2')">í¸ì§‘</button>
                    </div>
                </div>

                <div class="routine-category" data-category="nutrition">
                    <div class="category-header">
                        <span class="category-icon">ğŸ¥—</span>
                        <span class="category-title">ì‹ë‹¨</span>
                    </div>
                    <div class="routine-item" data-id="routine-3">
                        <div class="routine-checkbox" onclick="toggleRoutine(this)"></div>
                        <div class="routine-info">
                            <div class="routine-name">ë¬¼ 2L ë§ˆì‹œê¸°</div>
                            <div class="routine-time">í•˜ë£¨ì¢…ì¼</div>
                        </div>
                        <button class="edit-btn" onclick="showEditActions('routine-3')">í¸ì§‘</button>
                    </div>
                </div>

                <div class="routine-category" data-category="body">
                    <div class="category-header">
                        <span class="category-icon">ğŸ’†</span>
                        <span class="category-title">ë°”ë””ì¼€ì–´</span>
                    </div>
                    <div class="routine-item" data-id="routine-4">
                        <div class="routine-checkbox checked" onclick="toggleRoutine(this)"></div>
                        <div class="routine-info">
                            <div class="routine-name">ìŠ¤íŠ¸ë ˆì¹­ 10ë¶„</div>
                            <div class="routine-time">ì˜¤í›„ 9:00 - 9:10</div>
                        </div>
                        <button class="edit-btn" onclick="showEditActions('routine-4')">í¸ì§‘</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <button class="add-routine-btn" onclick="openAddModal()">+</button>

    <div class="modal" id="addModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">ë£¨í‹´ ì¶”ê°€í•˜ê¸°</h2>
                <button class="close-btn" onclick="closeAddModal()">Ã—</button>
            </div>

            <form id="routineForm" onsubmit="saveRoutine(event)">
                <input type="hidden" id="routineId">
                
                <div class="form-group">
                    <label class="form-label">ë£¨í‹´ ì´ë¦„</label>
                    <input type="text" id="routineName" class="form-input" placeholder="ì˜ˆ: ì•„ì¹¨ ì¡°ê¹…" required>
                </div>

                <div class="form-group">
                    <label class="form-label">ì¹´í…Œê³ ë¦¬</label>
                    <div class="category-select" id="categorySelect">
                        <div class="category-option" data-category="exercise" onclick="selectCategory(this)">ğŸƒ ìš´ë™</div>
                        <div class="category-option" data-category="nutrition" onclick="selectCategory(this)">ğŸ¥— ì‹ë‹¨</div>
                        <div class="category-option" data-category="body" onclick="selectCategory(this)">ğŸ’† ë°”ë””ì¼€ì–´</div>
                        <div class="category-option" data-category="recovery" onclick="selectCategory(this)">ğŸ˜´ íšŒë³µ/ì»¨ë””ì…”ë‹</div>
                        <div class="category-option" data-category="habit" onclick="selectCategory(this)">âœ¨ ìŠµê´€ ê°œì„ </div>
                    </div>
                </div>

                <div class="form-group">
                    <div class="day-select-header">
                        <label class="form-label">ìš”ì¼ ì„ íƒ</label>
                        <button type="button" class="select-all-btn" onclick="selectAllDays()">ì „ì²´ ì„ íƒ</button>
                    </div>
                    <div class="day-select" id="daySelect">
                        <div class="day-option" data-day="ì¼" onclick="selectDay(this)">ì¼</div>
                        <div class="day-option" data-day="ì›”" onclick="selectDay(this)">ì›”</div>
                        <div class="day-option" data-day="í™”" onclick="selectDay(this)">í™”</div>
                        <div class="day-option" data-day="ìˆ˜" onclick="selectDay(this)">ìˆ˜</div>
                        <div class="day-option" data-day="ëª©" onclick="selectDay(this)">ëª©</div>
                        <div class="day-option" data-day="ê¸ˆ" onclick="selectDay(this)">ê¸ˆ</div>
                        <div class="day-option" data-day="í† " onclick="selectDay(this)">í† </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label optional">ì‹œì‘ ì‹œê°„</label>
                    <div class="time-input">
                        <input type="time" id="startTime" class="form-input">
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label optional">ì¢…ë£Œ ì‹œê°„</label>
                    <div class="time-input">
                        <input type="time" id="endTime" class="form-input">
                    </div>
                </div>

                <button type="submit" class="submit-btn" id="submitBtn">ì¶”ê°€í•˜ê¸°</button>
            </form>
        </div>
    </div>

    <div class="edit-action-modal" id="editActionModal">
        <div class="edit-action-content">
            <button class="edit-action-btn modify" onclick="modifyRoutine()">ìˆ˜ì •í•˜ê¸°</button>
            <button class="edit-action-btn delete" onclick="deleteRoutine()">ì‚­ì œí•˜ê¸°</button>
            <button class="edit-action-btn cancel" onclick="closeEditActions()">ì·¨ì†Œ</button>
        </div>
    </div>

    <nav class="nav-bar">
        <a href="feed.html" class="nav-item">
            <span class="nav-icon">ğŸ </span>
            <span>í”¼ë“œ</span>
        </a>
        <a href="routine.html" class="nav-item active">
            <span class="nav-icon">ğŸ“‹</span>
            <span>ë£¨í‹´</span>
        </a>
        <a href="persona_lab.html" class="nav-item">
            <span class="nav-icon">ğŸ”¬</span>
            <span>ì±Œë¦°ì§€</span>
        </a>
        <a href="mypage.html" class="nav-item">
            <span class="nav-icon">ğŸ‘¤</span>
            <span>MY</span>
        </a>
    </nav>

<script>
    // ë£¨í‹´ ë°ì´í„° ì €ì¥ì†Œ
    let routines = [
        {
            id: 'routine-1',
            name: 'ì•„ì¹¨ ì¡°ê¹… 30ë¶„',
            category: 'exercise',
            startTime: '07:00',
            endTime: '07:30',
            days: ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ'],
            isChallenge: true
        },
        {
            id: 'routine-2',
            name: 'í”Œë­í¬ 2ë¶„',
            category: 'exercise',
            startTime: '20:00',
            endTime: '20:02',
            days: ['ì›”', 'ìˆ˜', 'ê¸ˆ']
        },
        {
            id: 'routine-3',
            name: 'ë¬¼ 2L ë§ˆì‹œê¸°',
            category: 'nutrition',
            startTime: '',
            endTime: '',
            days: ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† ']
        },
        {
            id: 'routine-4',
            name: 'ìŠ¤íŠ¸ë ˆì¹­ 10ë¶„',
            category: 'body',
            startTime: '21:00',
            endTime: '21:10',
            days: ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† ']
        }
    ];

    let currentRoutineId = null;
    let routineIdCounter = 5;

    // ì¹´í…Œê³ ë¦¬ë³„ ì•„ì´ì½˜ ë° ì´ë¦„
    const categoryInfo = {
        exercise: { icon: 'ğŸƒ', name: 'ìš´ë™' },
        nutrition: { icon: 'ğŸ¥—', name: 'ì‹ë‹¨' },
        body: { icon: 'ğŸ’†', name: 'ë°”ë””ì¼€ì–´' },
        recovery: { icon: 'ğŸ˜´', name: 'íšŒë³µ/ì»¨ë””ì…”ë‹' },
        habit: { icon: 'âœ¨', name: 'ìŠµê´€ ê°œì„ ' }
    };

    function switchMainTab(tab) {
        document.querySelectorAll('.main-tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        
        if (tab === 'dashboard') {
            document.querySelector('.main-tab:first-child').classList.add('active');
            document.getElementById('dashboardTab').classList.add('active');
        } else {
            document.querySelector('.main-tab:last-child').classList.add('active');
            document.getElementById('routineTab').classList.add('active');
        }
    }

    function renderCalendar() {
        const calendarDays = document.getElementById('calendarDays');
        calendarDays.innerHTML = '';
        
        const year = 2024;
        const month = 10;
        const firstDay = new Date(year, month, 1).getDay();
        const daysInMonth = new Date(year, month + 1, 0).getDate();
        const today = 21;
        
        const completedDays = [1, 2, 4, 5, 8, 9, 11, 12, 15, 16, 18, 19];
        
        for (let i = 0; i < firstDay; i++) {
            const emptyDay = document.createElement('div');
            emptyDay.className = 'calendar-day empty';
            calendarDays.appendChild(emptyDay);
        }
        
        for (let day = 1; day <= daysInMonth; day++) {
            const dayElement = document.createElement('div');
            dayElement.className = 'calendar-day';
            dayElement.textContent = day;
            
            if (completedDays.includes(day)) {
                dayElement.classList.add('completed');
            }
            if (day === today) {
                dayElement.classList.add('today');
            }
            
            calendarDays.appendChild(dayElement);
        }
    }

    function previousMonth() {
        console.log('ì´ì „ ë‹¬');
    }

    function nextMonth() {
        console.log('ë‹¤ìŒ ë‹¬');
    }

    function previousDay() {
        console.log('ì´ì „ ë‚ ');
    }

    function nextDay() {
        console.log('ë‹¤ìŒ ë‚ ');
    }

    function toggleRoutine(element) {
        element.classList.toggle('checked');
    }

    // AI ì¶”ì²œ ë£¨í‹´ ì„ íƒ/í•´ì œ
    function toggleSuggestedRoutine(element) {
        element.classList.toggle('selected');
    }

    // AI ì¶”ì²œ ë£¨í‹´ ì ìš©
    function applyRecommendations() {
        const selectedRoutines = document.querySelectorAll('.suggested-routine.selected');
        
        if (selectedRoutines.length === 0) {
            alert('ì¶”ê°€í•  ë£¨í‹´ì„ ì„ íƒí•´ì£¼ì„¸ìš”!');
            return;
        }

        selectedRoutines.forEach(routineEl => {
            const routineData = JSON.parse(routineEl.dataset.routine);
            const newRoutine = {
                id: `routine-${routineIdCounter++}`,
                name: routineData.name,
                category: routineData.category,
                startTime: routineData.startTime,
                endTime: routineData.endTime,
                days: routineData.days
            };
            
            routines.push(newRoutine);
        });

        renderRoutineList();
        alert(`${selectedRoutines.length}ê°œì˜ ë£¨í‹´ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!`);
        
        // ì„ íƒ í•´ì œ
        selectedRoutines.forEach(el => el.classList.remove('selected'));
    }

    // ë£¨í‹´ ë¦¬ìŠ¤íŠ¸ ë Œë”ë§
    function renderRoutineList() {
        const routineList = document.getElementById('routineList');
        routineList.innerHTML = '';

        // ì¹´í…Œê³ ë¦¬ë³„ë¡œ ê·¸ë£¹í™”
        const groupedRoutines = {};
        routines.forEach(routine => {
            if (!groupedRoutines[routine.category]) {
                groupedRoutines[routine.category] = [];
            }
            groupedRoutines[routine.category].push(routine);
        });

        // ê° ì¹´í…Œê³ ë¦¬ë³„ë¡œ ë Œë”ë§
        Object.keys(groupedRoutines).forEach(category => {
            const categoryDiv = document.createElement('div');
            categoryDiv.className = 'routine-category';
            categoryDiv.dataset.category = category;

            const info = categoryInfo[category];
            
            categoryDiv.innerHTML = `
                <div class="category-header">
                    <span class="category-icon">${info.icon}</span>
                    <span class="category-title">${info.name}</span>
                </div>
            `;

            groupedRoutines[category].forEach(routine => {
                const timeDisplay = routine.startTime && routine.endTime 
                    ? `${formatTime(routine.startTime)} - ${formatTime(routine.endTime)}`
                    : routine.startTime 
                    ? `${formatTime(routine.startTime)}`
                    : 'í•˜ë£¨ì¢…ì¼';

                const routineItem = document.createElement('div');
                routineItem.className = 'routine-item';
                routineItem.dataset.id = routine.id;
                routineItem.innerHTML = `
                    <div class="routine-checkbox" onclick="toggleRoutine(this)"></div>
                    <div class="routine-info">
                        <div class="routine-name">
                            ${routine.name}
                            ${routine.isChallenge ? '<span class="challenge-badge">ì±Œë¦°ì§€</span>' : ''}
                        </div>
                        <div class="routine-time">${timeDisplay}</div>
                    </div>
                    <button class="edit-btn" onclick="showEditActions('${routine.id}')">í¸ì§‘</button>
                `;
                categoryDiv.appendChild(routineItem);
            });

            routineList.appendChild(categoryDiv);
        });
    }

    // ì‹œê°„ í¬ë§·íŒ… í•¨ìˆ˜
    function formatTime(time) {
        if (!time) return '';
        const [hour, minute] = time.split(':');
        const h = parseInt(hour);
        const period = h >= 12 ? 'ì˜¤í›„' : 'ì˜¤ì „';
        const displayHour = h > 12 ? h - 12 : (h === 0 ? 12 : h);
        return `${period} ${displayHour}:${minute}`;
    }

    function openAddModal() {
        document.getElementById('modalTitle').textContent = 'ë£¨í‹´ ì¶”ê°€í•˜ê¸°';
        document.getElementById('submitBtn').textContent = 'ì¶”ê°€í•˜ê¸°';
        document.getElementById('routineForm').reset();
        document.getElementById('routineId').value = '';
        document.querySelectorAll('.category-option').forEach(opt => opt.classList.remove('selected'));
        document.querySelectorAll('.day-option').forEach(opt => opt.classList.remove('selected'));
        currentRoutineId = null;
        document.getElementById('addModal').classList.add('active');
    }

    function closeAddModal() {
        document.getElementById('addModal').classList.remove('active');
    }

    function selectCategory(element) {
        document.querySelectorAll('.category-option').forEach(opt => {
            opt.classList.remove('selected');
        });
        element.classList.add('selected');
    }

    function selectDay(element) {
        element.classList.toggle('selected');
    }

    function selectAllDays() {
        const dayOptions = document.querySelectorAll('.day-option');
        const allSelected = Array.from(dayOptions).every(opt => opt.classList.contains('selected'));
        
        dayOptions.forEach(opt => {
            if (allSelected) {
                opt.classList.remove('selected');
            } else {
                opt.classList.add('selected');
            }
        });
    }

    function saveRoutine(event) {
        event.preventDefault();
        
        const routineId = document.getElementById('routineId').value;
        const name = document.getElementById('routineName').value;
        const category = document.querySelector('.category-option.selected')?.dataset.category;
        const startTime = document.getElementById('startTime').value;
        const endTime = document.getElementById('endTime').value;
        const selectedDays = Array.from(document.querySelectorAll('.day-option.selected'))
            .map(el => el.dataset.day);

        if (!category) {
            alert('ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”!');
            return;
        }

        if (selectedDays.length === 0) {
            alert('ìš”ì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”!');
            return;
        }

        const isEdit = routineId !== '';
        
        if (isEdit) {
            // ìˆ˜ì •
            const routine = routines.find(r => r.id === routineId);
            if (routine) {
                routine.name = name;
                routine.category = category;
                routine.startTime = startTime;
                routine.endTime = endTime;
                routine.days = selectedDays;
            }
            alert('ë£¨í‹´ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!');
        } else {
            // ì¶”ê°€
            const newRoutine = {
                id: `routine-${routineIdCounter++}`,
                name: name,
                category: category,
                startTime: startTime,
                endTime: endTime,
                days: selectedDays
            };
            routines.push(newRoutine);
            alert('ë£¨í‹´ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }
        
        renderRoutineList();
        closeAddModal();
    }

    function showEditActions(routineId) {
        currentRoutineId = routineId;
        console.log('Setting currentRoutineId:', currentRoutineId); // ë””ë²„ê·¸
        document.getElementById('editActionModal').classList.add('active');
    }

    function closeEditActions() {
        document.getElementById('editActionModal').classList.remove('active');
    }

    function modifyRoutine() {
        console.log('modifyRoutine called, currentRoutineId:', currentRoutineId); // ë””ë²„ê·¸
        
        if (!currentRoutineId) {
            alert('ë£¨í‹´ IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            return;
        }
        
        const routine = routines.find(r => r.id === currentRoutineId);
        console.log('Found routine:', routine); // ë””ë²„ê·¸
        
        if (!routine) {
            alert('ë£¨í‹´ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            return;
        }
        
        // í¸ì§‘ ì•¡ì…˜ ëª¨ë‹¬ ë‹«ê¸°
        closeEditActions();
        
        // ì•½ê°„ì˜ ë”œë ˆì´ í›„ í¼ ëª¨ë‹¬ ì—´ê¸°
        setTimeout(() => {
            // ëª¨ë‹¬ íƒ€ì´í‹€ ë³€ê²½
            document.getElementById('modalTitle').textContent = 'ë£¨í‹´ ìˆ˜ì •í•˜ê¸°';
            document.getElementById('submitBtn').textContent = 'ìˆ˜ì •í•˜ê¸°';
            
            // í¼ì— ê¸°ì¡´ ë°ì´í„° ì±„ìš°ê¸°
            document.getElementById('routineId').value = routine.id;
            document.getElementById('routineName').value = routine.name;
            document.getElementById('startTime').value = routine.startTime || '';
            document.getElementById('endTime').value = routine.endTime || '';
            
            // ì¹´í…Œê³ ë¦¬ ì„ íƒ
            document.querySelectorAll('.category-option').forEach(opt => {
                opt.classList.remove('selected');
                if (opt.dataset.category === routine.category) {
                    opt.classList.add('selected');
                }
            });
            
            // ìš”ì¼ ì„ íƒ
            document.querySelectorAll('.day-option').forEach(opt => {
                opt.classList.remove('selected');
                if (routine.days.includes(opt.dataset.day)) {
                    opt.classList.add('selected');
                }
            });
            
            // ëª¨ë‹¬ ì—´ê¸°
            document.getElementById('addModal').classList.add('active');
        }, 200);
    }

    function deleteRoutine() {
        if (!currentRoutineId) return;
        
        if (confirm('ì´ ë£¨í‹´ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
            // ë°°ì—´ì—ì„œ í•´ë‹¹ ë£¨í‹´ ì‚­ì œ
            routines = routines.filter(r => r.id !== currentRoutineId);
            
            // UI ì—…ë°ì´íŠ¸
            renderRoutineList();
            
            closeEditActions();
            alert('ë£¨í‹´ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
        }
    }

    // ì´ˆê¸° ë Œë”ë§
    renderCalendar();
    renderRoutineList();
</script>
    <script src="tour-system.js"></script>
</body>
</html>